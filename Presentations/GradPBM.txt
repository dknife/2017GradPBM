Foundation of Physically Based Modeling and Animation